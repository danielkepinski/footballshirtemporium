{% extends "shop/base.html" %}
{% load static %}

{% block title %}{% if category %}{{ category.name }}{% else %}Products{% endif %}{% endblock %}

{% block content %}
  <div class="container" style="display:grid; grid-template-columns: 240px 1fr; gap: 24px;">
    <!-- Sidebar: categories -->
    <aside>
      <h3>Categories</h3>
      <ul style="list-style:none; padding:0; margin:12px 0; display:grid; gap:8px;">
        <li {% if not category %}class="selected"{% endif %}>
          <a href="{% url 'shop:product_list' %}">All</a>
        </li>
        {% for c in categories %}
          <li {% if category and category.slug == c.slug %}class="selected"{% endif %}>
            <a href="{{ c.get_absolute_url }}">{{ c.name }}</a>
          </li>
        {% endfor %}
      </ul>
    </aside>

    <!-- Main: product grid -->
    <section>
      <h1 style="margin-top:0;">
        {% if category %}{{ category.name }}{% else %}Products{% endif %}
      </h1>

      <div class="grid">
        {% for product in products %}
          <a class="card" href="{{ product.get_absolute_url }}">
            <img
              class="card__img"
              src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}"
              alt="{{ product.name }}"
            >
            <div class="card__body">
              <h3 class="card__title">{{ product.name }}</h3>
              <div class="card__meta">
                <span>Â£{{ product.price }}</span>
              </div>
            </div>
          </a>
        {% empty %}
          <p>No products found.</p>
        {% endfor %}
      </div>
    </section>
  </div>
{% endblock %}
